class Solution {
public: 
    int t[301][301] ;
    int solve(int i, int j, vector<vector<int>>& mat) {
        if(i < 0 || j < 0 || !mat[i][j]) return 0 ;
        if(t[i][j] != -1) return t[i][j] ;
        int a = solve(i-1, j, mat) ;
        int b = solve(i-1, j-1, mat) ;
        int c = solve(i, j-1, mat) ;
        return t[i][j] = min({a, b, c}) + 1 ;
    }
    int countSquares(vector<vector<int>>& mat) {
        int m = mat.size(), n = mat[0].size() ;
        if(m == 1 && n == 1) return mat[0][0] ;
        memset(t, -1, sizeof(t)) ;
        int cnt = 0 ;
        for(int i = 0; i < m; i++) {
            for(int j = 0; j < n; j++) {
                if(mat[i][j]) cnt += solve(i, j, mat) ;
            }
        }
        return cnt ;
    }
};
