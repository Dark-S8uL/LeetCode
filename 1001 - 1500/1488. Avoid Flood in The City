class Solution {
public:
    vector<int> avoidFlood(vector<int>& rains) {
        int n = rains.size() ;
        vector<int> v(n, 1) ;
        unordered_map<int, int> mp ;
        set<int> st ;
        for(int i = 0; i < n; i++) {
            if(rains[i] > 0) {
                int lake = rains[i] ;
                v[i] = -1 ;
                if(mp.count(lake)) {
                    auto it = st.upper_bound(mp[lake]) ;
                    if(it == st.end()) return {} ;
                    v[*it] = lake ;
                    st.erase(it) ;
                }
                mp[lake] = i ;
            } else st.insert(i) ;
        }
        return v ;
    }
};
